{"version":3,"names":["ccclass","_coreDataDecoratorsIndexJs","displayOrder","type","serializable","_defineJs","SetIndex","_passPhaseJs","getPhaseID","_renderQueueJs","renderQueueClearFunc","convertRenderQueue","renderQueueSortFunc","_gfxIndexJs","ClearFlagBit","Color","Rect","_renderInstancedQueueJs","RenderInstancedQueue","_renderStageJs","RenderStage","_enumJs","ForwardStagePriority","_renderAdditiveLightQueueJs","RenderAdditiveLightQueue","_renderSceneCorePassJs","BatchingSchemes","_pipelineSerializationJs","RenderQueueDesc","RenderQueueSortMode","_planarShadowQueueJs","PlanarShadowQueue","_uiPhaseJs","UIPhase","_pipelineFuncsJs","renderProfiler","execute","colors","_export","ForwardStage","_dec","_dec2","_dec3","_class","_class2","_class3","_RenderStage","_inheritsLoose","_this","call","renderQueues","_initializer","_renderQueues","_renderArea","_instancedQueue","_phaseID","_clearFlag","additiveInstanceQueues","_uiPhase","_proto","prototype","addRenderInstancedQueue","queue","includes","push","removeRenderInstancedQueue","index","indexOf","splice","initialize","info","activate","pipeline","flow","i","length","_additiveLightQueue","_pipeline","_planarQueue","destroy","render","camera","_camera$geometryRende","clear","device","forEach","renderObjects","pipelineSceneData","m","p","k","ro","subModels","model","subModel","passes","pass","phase","batchingScheme","INSTANCING","instancedBuffer","getInstancedBuffer","merge","add","insertRenderPass","sort","cmdBuff","commandBuffers","pipelineUBO","updateShadowUBO","uploadBuffers","gatherLightPasses","gatherShadowPasses","clearFlag","COLOR","x","clearColor","y","z","w","generateRenderArea","framebuffer","window","renderPass","getRenderPass","beginRenderPass","clearDepth","clearStencil","bindDescriptorSet","GLOBAL","descriptorSet","recordCommandBuffer","geometryRenderer","profiler","endRenderPass","initInfo","name","priority","FORWARD","tag","isTransparent","sortMode","FRONT_TO_BACK","stages","BACK_TO_FRONT","_applyDecoratedInitializer"],"sources":["../../../../../../../../../cocos/rendering/forward/forward-stage.ts"],"mappings":"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"}