{"version":3,"names":["DEBUG","_virtualInternal253AconstantsJs","_coreDataDecoratorsIndexJs","ccclass","serializable","_corePoseJs","blendPoseInto","_defineJs","CLASS_NAME_PREFIX_ANIM","_poseNodeJs","PoseNode","PoseTransformSpaceRequirement","_animationGraphContextJs","AnimationGraphUpdateContextGenerator","_decoratorNodeJs","poseGraphNodeHide","_coreIndexJs","assertIsTrue","lerp","_utilsJs","isIgnorableWeight","execute","ZERO_ALTERING_DURATION_THRESHOLD","_export","PoseNodeChoosePoseBase","_dec","_dec2","_class","_class2","_PoseNode","_inheritsLoose","initialChoiceCount","_this","call","_poses","_initializer","_fadeInDurations","_initializer2","_updateContextGenerator","_evaluationRecord","undefined","length","fill","_proto","prototype","bind","context","_iterator","_createForOfIteratorHelperLoose","_step","done","pose","value","evaluationRecord","EvaluationRecord","getChosenIndex","settle","_iterator2","_step2","reenter","_iterator3","_step3","doUpdate","poses","update","deltaTime","allWeightsAreZero","nPoses","items","iPose","weight","itemUpdateContext","generate","indicativeWeight","doEvaluate","spaceRequirement","LOCAL","finalPose","sumWeight","iInputPose","_poses$iInputPose","inputPoseWeight","inputPose","evaluate","t","popPose","evaluateDefaultPose","_applyDecoratedInitializer","itemCount","initialChosenIndex","_items","_chosenPoseIndex","_elapsedTransitionTime","_blendingDuration","Array","from","ItemEvaluationRecord","selfSourceWeight","selfTargetWeight","_proto2","newChoseIndex","fadeInDurations","_checkAlternation","elapsedTransitionTime","blendingDuration","newUniformTransformRatio","remain","item","selfWeight","every","oldChoseIndex","newFadeInDuration","Math","max","oldUniformTransitionRatio","_createClass","key","get"],"sources":["../../../../../../../../../../../../cocos/animation/marionette/pose-graph/pose-nodes/choose-pose/choose-pose-base.ts"],"mappings":"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"}