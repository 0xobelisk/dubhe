{"version":3,"names":["mixAveragedVec3","result","previous","accumulatedWeight","input","weight","newSum","Vec3","copy","t","lerp","mixAveragedQuat","Quat","slerp","setters","_coreIndexJs","execute","_export","BlendStateBuffer","_nodeBlendStates","Map","_proto","prototype","createWriter","node","property","host","constants","propertyBlendState","ref","BlendStateWriterInternal","destroyWriter","writer","internal","deRef","nodeBlendState","get","createNodeBlendState","set","refProperty","deRefProperty","empty","apply","forEach","_node","_property","_propertyBlendState","_host","_constants","_proto2","getValue","setValue","value","blend","_createClass","key","TransformApplyFlag","TRANSFORM_APPLY_FLAGS_ALL","POSITION","ROTATION","SCALE","EULER_ANGLES","LegacyVec3PropertyBlendState","refCount","_proto3","reset","zero","LegacyQuatPropertyBlendState","_proto4","identity","NodeBlendState","_transformApplyFlags","_properties","_proto5","_properties$property","_properties$property2","properties","_createVec3BlendState","_createQuatBlendState","rotation","transformApplyFlags","_this$_properties","position","scale","eulerAngles","s","r","setRTS","LegacyNodeBlendState","_NodeBlendState","_inheritsLoose","arguments","_proto6","_this$_properties2","call","_currentValue","LegacyBlendStateBuffer","_BlendStateBuffer","_proto7"],"sources":["../../../../../../../../../cocos/3d/skeletal-animation/skeletal-animation-blending.ts"],"mappings":"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"}