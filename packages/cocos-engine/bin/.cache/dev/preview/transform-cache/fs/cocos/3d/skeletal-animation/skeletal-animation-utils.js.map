{"version":3,"names":["selectJointsMediumFormat","device","getFormatFeatures","Format","RGBA32F","FormatFeatureBit","SAMPLED_TEXTURE","RGBA8","uploadJointDataLBS","out","base","mat","firstBone","m00","m01","m02","m12","m04","m05","m06","m13","m08","m09","m10","m14","uploadJointDataDQS","Mat4","toRTS","qt_1","v3_1","v3_2","Quat","copy","dq_0","dot","multiplyScalar","set","dq_1","x","y","z","multiply","w","roundUpTextureSize","targetLength","formatSize","formatScale","Math","sqrt","ceil","max","MINIMUM_JOINT_TEXTURE_SIZE","_export","setters","_virtualInternal253AconstantsJs","EDITOR","JSB","_skeletalAnimationDataHubJs","SkelAnimDataHub","_animationTransformUtilsJs","getWorldTransformUntilRoot","_coreIndexJs","geometry","Vec3","_gfxIndexJs","BufferUsageBit","FormatInfos","MemoryUsageBit","BufferInfo","_renderingDefineJs","UBOSkinningAnimation","_renderSceneCoreTextureBufferPoolJs","TextureBufferPool","_miscJointTextureSamplerInfoJs","jointTextureSamplerInfo","execute","uploadJointData","v3_3","v3_4","v3_min","v3_max","m4_1","m4_2","ab_1","AABB","Inf","Number","MAX_SAFE_INTEGER","JointTexturePool","_device","_pool","_textureBuffers","Map","_formatSize","_pixelsPerJoint","_customPool","_chunkIdxMap","format","size","initialize","roundUpFn","_proto","prototype","clear","destroy","registerCustomTextureLayouts","layouts","i","length","layout","textureLength","chunkIdx","createChunk","j","contents","content","skeleton","k","clips","clip","getDefaultPoseTexture","mesh","skinningRoot","hash","texture","get","bounds","has","refCount","joints","bindposes","textureBuffer","buildTexture","jointCount","bufSize","customChunkIdx","handle","undefined","alloc","Float32Array","BYTES_PER_ELEMENT","pixelOffset","start","skeletonHash","clipHash","readyToBeDeleted","boneSpaceBounds","getBoneSpaceBounds","offset","node","getChildByPath","inverseBindposes","bound","transform","getBoundary","min","IDENTITY","fromPoints","update","buffer","getSequencePoseTexture","clipData","getOrExtract","frames","animInfos","_createAnimInfos","f","push","_j","curveData","downstream","bindposeIdx","bindposeCorrection","transformValid","boneSpaceBound","center","halfExtents","releaseHandle","free","releaseSkeleton","it","values","res","next","done","value","releaseAnimationClip","animPath","source","animNode","correctionPath","idx","lastIndexOf","substring","fromRTS","rotation","position","scale","parent","t","transforms","_createClass","key","JointAnimationInfo","_proto2","getData","nodeID","createBuffer","UNIFORM","TRANSFER_DST","HOST","DEVICE","SIZE","data","info","dirty","dirtyForJSB","Uint8Array","currentClip","switchClip","_iterator","_createForOfIteratorHelperLoose","_step"],"sources":["../../../../../../../../../cocos/3d/skeletal-animation/skeletal-animation-utils.ts"],"mappings":"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"}