{"version":3,"names":["Label","_componentsIndexJs","_utilsDynamicAtlasAtlasManagerJs","dynamicAtlasManager","_textProcessingJs","TextProcessing","_uiViewJs","view","_coreIndexJs","approx","execute","Overflow","_export","ttfUtils","updateProcessingData","style","layout","outputLayoutData","outputRenderData","comp","trans","isSystemFontUsed","useSystemFont","fontSize","nodeContentSize","width","canvasSize","height","lineHeight","overFlow","overflow","NONE","wrapping","RESIZE_HEIGHT","enableWrapText","isBold","isItalic","isUnderline","underlineHeight","isOutlined","enableOutline","outlineWidth","outlineColor","set","isShadow","enableShadow","shadowBlur","shadowOffset","x","y","hasShadow","shadowColor","shadowOffsetX","shadowOffsetY","color","texture","spriteFrame","uiTransAnchorX","anchorX","uiTransAnchorY","anchorY","horizontalAlign","verticalAlign","getAssemblerData","sharedLabelData","_canvasPool","get","canvas","resetAssemblerData","assemblerData","put","updateRenderData","renderData","vertDirty","node","_uiProps","uiTransformComp","processing","instance","textStyle","textLayout","textLayoutData","textRenderData","fontScale","getScaleX","setCanvasUsed","context","fontFamily","_updateFontFamily","_resetDynamicAtlas","processingString","string","generateRenderInfo","generateVertexData","textureDirty","_calDynamicAtlas","actualFontSize","setContentSize","datalist","data","vertexBuffer","updateUVs","contentWidth","appX","appY","updateVertexData","_fontFamily","font","_nativeAsset","cacheMode","CacheMode","BITMAP","frame","ttfSpriteFrame","packToDynamicAtlas","deleteAtlasSpriteFrame","_resetDynamicAtlasFrame"],"sources":["../../../../../../../../../../cocos/2d/assembler/label/ttfUtils.ts"],"mappings":"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"}