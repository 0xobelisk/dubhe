{"version":3,"names":["getPassIndex","subModel","passes","r","cclegacy","rendering","isEnableEffect","_phaseID","getPhaseID","getPassID","k","length","enableEffectImport","phase","phaseID","getReflectMapPassIndex","_phaseReflectMapID","setters","_defineJs","SetIndex","_passPhaseJs","_pipelineStateManagerJs","PipelineStateManager","_renderSceneCorePassJs","BatchingSchemes","_renderSceneSceneReflectionProbeJs","ProbeType","_renderSceneSceneCameraJs","SKYBOX_FLAG","_renderInstancedQueueJs","RenderInstancedQueue","_coreIndexJs","geometry","execute","CC_USE_RGBE_OUTPUT","_export","RenderReflectionProbeQueue","pipeline","_pipeline","_subModelsArray","_passArray","_shaderArray","_rgbeSubModelsArray","_instancedQueue","_patches","_proto","prototype","gatherRenderObjects","probe","camera","cmdBuff","clear","scene","sceneData","pipelineSceneData","skybox","enabled","model","clearFlag","add","models","visibility","i","node","isCulledByLod","layer","visFlags","worldBounds","bakeToReflectionProbe","probeType","CUBE","intersect","aabbWithAABB","boundingBox","aabbFrustum","frustum","uploadBuffers","subModels","j","isTransparent","blendState","targets","blend","passIdx","bUseReflectPass","pass","batchingScheme","concat","patches","useRGBEPatchs","name","value","onMacroPatchesStateChanged","push","INSTANCING","buffer","getInstancedBuffer","merge","queue","shader","shaders","recordCommandBuffer","device","renderPass","ia","inputAssembler","pso","getOrCreatePipelineState","descriptorSet","bindPipelineState","bindDescriptorSet","MATERIAL","LOCAL","bindInputAssembler","draw","resetRGBEMacro","patch","splice"],"sources":["../../../../../../../../cocos/rendering/render-reflection-probe-queue.ts"],"mappings":"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"}