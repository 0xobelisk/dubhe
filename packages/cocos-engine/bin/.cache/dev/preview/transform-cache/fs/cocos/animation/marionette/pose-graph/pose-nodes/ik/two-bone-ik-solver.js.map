{"version":3,"names":["EDITOR","_virtualInternal253AconstantsJs","_coreDataDecoratorsIndexJs","ccclass","editable","serializable","type","visible","_defineJs","CLASS_NAME_PREFIX_ANIM","_poseNodeJs","PoseTransformSpaceRequirement","_coreIndexJs","assertIsTrue","ccenum","Vec3","_decoratorInputJs","input","_decoratorNodeJs","poseGraphNodeCategory","_modifyPoseBaseJs","PoseNodeModifyPoseBase","_solveTwoBoneIkJs","solveTwoBoneIK","_coreTransformJs","Transform","_foundationTypeSystemJs","PoseGraphType","_transformSpaceJs","TransformSpace","_menuJs","POSE_GRAPH_NODE_MENU_PREFIX_IK","execute","cacheRootTransform","cacheMiddleTransform","cacheEndEffectorTransform","cacheEndEffectorTargetPosition","cachePoleTargetPosition","cacheTransform_evaluateTarget","TargetSpecificationType","TargetSpecification","_dec","_dec2","_dec3","VALUE","_dec4","_dec5","_dec6","BONE","_class","_class2","_initializer","targetPosition","_initializer2","targetPositionSpace","_initializer3","targetBone","_initializer4","_sourceBoneHandle","undefined","_targetBoneHandle","_proto","prototype","bind","context","sourceBoneHandle","_context$bindTransfor","bindTransformByName","evaluate","outTargetPosition","pose","transforms","getPosition","index","NONE","targetTransform","setIdentity","position","_convertTransformToPoseTransformSpace","copy","_applyDecoratedInitializer","WORLD","_export","PoseNodeTwoBoneIKSolver","_dec7","_dec8","_dec9","VEC3","_dec10","endEffectorTarget","_dec11","_dec12","poleTarget","_class4","_class5","_PoseNodeModifyPoseBa","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","debug","_initializer5","endEffectorBoneName","_initializer6","_initializer7","_initializer8","_workspace","_proto2","parentBoneName","getParentBoneNameByName","ikRootBoneName","hEndEffector","hMiddle","hIKRoot","destroy","Workspace","getPoseTransformSpaceRequirement","COMPONENT","modifyPose","inputPose","modificationQueue","workspace","iRootTransform","hRoot","iMiddleTransform","iEndEffectorTransform","rootTransform","getTransform","middleTransform","endEffectorTransform","endEffectorTargetPosition","poleTargetPosition","push","_createClass","key","get","set","value","_applyDecoratedDescriptor","Object","getOwnPropertyDescriptor","getTitle"],"sources":["../../../../../../../../../../../../cocos/animation/marionette/pose-graph/pose-nodes/ik/two-bone-ik-solver.ts"],"mappings":"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"}