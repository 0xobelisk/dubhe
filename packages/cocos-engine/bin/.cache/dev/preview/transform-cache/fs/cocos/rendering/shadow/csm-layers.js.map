{"version":3,"names":["setters","_renderSceneSceneShadowsJs","CSMLevel","CSMOptimizationMode","_coreMathIndexJs","Mat4","Vec3","Vec2","Vec4","_coreGeometryIndexJs","Frustum","AABB","_coreMemopCachedArrayJs","CachedArray","_coreIndexJs","cclegacy","execute","_mat4Trans","_matShadowTrans","_matShadowView","_matShadowProj","_matShadowViewProj","_matShadowViewProjArbitaryPos","_matShadowViewProjArbitaryPosInv","_focus","_projPos","_texelSize","_projSnap","_snap","_maxVec3","_minVec3","_shadowPos","_maxLayerPosz","_maxLayerFarPlane","_export","ShadowLayerVolume","level","_shadowObjects","_shadowCameraFar","_level","_validFrustum","_splitFrustum","_lightViewFrustum","_castLightViewBoundingBox","accurate","_proto","prototype","copyToValidFrustum","validFrustum","copy","calculateValidFrustumOrtho","width","height","near","far","transform","createOrtho","calculateSplitFrustum","camera","m","start","end","split","aspect","fov","destroy","length","createMatrix","dirLight","shadowMapWidth","onlyForCulling","device","director","root","invisibleOcclusionRange","shadowInvisibleOcclusionRange","fromRT","node","rotation","invert","shadowViewArbitaryPos","clone","fromPoints","mergeFrustum","orthoSizeWidth","orthoSizeHeight","csmOptimizationMode","DisableRotationFix","halfExtents","x","y","distance","vertices","csmLevel","pipeline","pipelineSceneData","csmSupported","RemoveDuplicates","z","center","alignFarPlaneDist","Math","abs","max","r","set","transformMat4","halfOrthoSizeWidth","halfOrthoSizeHeight","ortho","capabilities","clipSpaceMinZ","clipSpaceSignY","multiply","invActualSize","modX","modY","_createClass","key","get","val","CSMShadowLayer","_ShadowLayerVolume","_inheritsLoose","_this","call","_splitCameraNear","_splitCameraFar","_csmAtlas","_calculateAtlas","_proto2","floor","CSMLayers","_castShadowObjects","_layerObjects","_layers","_levelCount","_specialLayer","_shadowDistance","i","LEVEL_4","_proto3","update","sceneData","scene","mainLight","shadowInfo","shadows","levelCount","shadowDistance","enabled","shadowEnabled","shadowFixedArea","_updateFixedArea","csmNeedUpdate","_splitFrustumLevels","_calculateCSM","shadowOrthoSize","shadowNear","shadowFar","getWorldRotation","getWorldPosition","matShadowView","matShadowProj","matShadowViewProj","nd","fd","ratio","lambda","csmLayerLambda","splitCameraNear","si","preNear","pow","nextFar","splitCameraFar","size","_getCameraWorldMatrix","csmLayer","LEVEL_1","shadowCameraFar","out","cameraNode","position"],"sources":["../../../../../../../../../cocos/rendering/shadow/csm-layers.ts"],"mappings":"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"}