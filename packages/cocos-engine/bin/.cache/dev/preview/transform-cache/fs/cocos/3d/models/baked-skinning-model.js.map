{"version":3,"names":["setters","_coreIndexJs","cclegacy","_gfxIndexJs","BufferUsageBit","MemoryUsageBit","BufferInfo","_renderingDefineJs","INST_JOINT_ANIM_INFO","UBOSkinningAnimation","UBOSkinningTexture","UNIFORM_JOINT_TEXTURE_BINDING","_renderSceneSceneModelJs","ModelType","_morphModelJs","MorphModel","_miscJointTextureSamplerInfoJs","jointTextureSamplerInfo","execute","myPatches","name","value","_export","BakedSkinningModel","_MorphModel","_inheritsLoose","_this","call","uploadedAnim","undefined","_jointsMedium","_skeleton","_mesh","_dataPoolManager","_instAnimInfoIdx","type","BAKED_SKINNING","director","root","dataPoolManager","jointTextureInfo","Float32Array","animInfo","jointAnimationInfo","getData","buffer","texture","boundsInfo","_proto","prototype","destroy","_applyJointTexture","bindSkeleton","skeleton","skinningRoot","mesh","transform","resMgr","uuid","_device","createBuffer","UNIFORM","TRANSFER_DST","DEVICE","SIZE","updateTransform","stamp","_this$_jointsMedium","skelBound","data","worldBounds","_worldBounds","node","_mat","_pos","_rot","_scale","updateUBOs","info","hasNonInstancingPass","idx","i","_subModels","length","subModel","view","instancedAttributeBlock","views","dirty","update","getMacroPatches","subModelIndex","patches","concat","uploadAnimation","anim","jointTexturePool","getSequencePoseTexture","bounds","get","hash","_modelBounds","getDefaultPoseTexture","oldTex","releaseHandle","_this$_jointsMedium2","handle","width","joints","pixelOffset","updateInstancedJointTextureInfo","tex","descriptorSet","bindTexture","_updateLocalDescriptors","submodelIdx","_this$_jointsMedium3","bindBuffer","BINDING","sampler","getSampler","bindSampler","_updateInstancedAttributes","attributes","getInstancedAttributeIndex","_this$_jointsMedium4"],"sources":["../../../../../../../../../cocos/3d/models/baked-skinning-model.ts"],"mappings":"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"}