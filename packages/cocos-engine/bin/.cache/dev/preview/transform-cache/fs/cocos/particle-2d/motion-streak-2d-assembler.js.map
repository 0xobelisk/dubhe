{"version":3,"names":["normal","out","dir","x","y","computeMiter","miter","lineA","lineB","halfThick","maxMultiple","add","_tangent","normalize","_vec2","multiple","dot","Math","min","setters","_virtualInternal253AconstantsJs","JSB","_motionStreak2dJs","MotionStreak","_coreIndexJs","Vec2","Color","execute","_normal","_export","MotionStreakAssembler","createData","comp","renderData","requestRenderData","dataLength","resize","update","dt","stroke","node","matrix","worldMatrix","tx","m12","ty","m13","points","cur","length","point","difx","dify","minSeg","Point","unshift","setPoint","time","fadeTime","vertexCount","indexCount","updateRenderDataCache","color","cr","r","cg","g","cb","b","ca","a","prev","distance","subtract","setDir","data","findLast","i","p","splice","progress","next","da","c","offset","u","v","_val","createQuadIndices","chunk","setIndexBuffer","QUAD_INDICES","updateWorldVertexAllData","updateRenderData","texture","markForUpdateRenderData","stride","floatStride","dataList","vData","vb","z","toArray","vid","meshBuffer","indexOffset","Uint16Array","l","start","passDirty","updatePass","nodeDirty","updateNode","textureDirty","updateTexture","material","getRenderMaterial","hashDirty","updateHash","renderDrawInfo","setVertDirty","hasChangedFlags","updateColor","fillBuffers","renderer","vertexOffset","vert","bid","bufferId","ib","iData","setDirty","MotionStreakAssemblerManager","getAssembler","Assembler"],"sources":["../../../../../../../../cocos/particle-2d/motion-streak-2d-assembler.ts"],"mappings":"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"}