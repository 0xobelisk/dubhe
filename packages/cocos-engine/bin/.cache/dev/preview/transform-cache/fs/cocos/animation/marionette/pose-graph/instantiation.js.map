{"version":3,"names":["isEvaluatableNode","node","PoseNode","PureValueNode","instantiatePoseGraph","graph","linkContext","mayCountMotionTime","outputNode","outputNodeShell","getShell","assertIsTrue","bindings","getBindings","length","InstantiatedPoseGraph","undefined","binding","outputIndex","producer","instantiationMap","Map","mainRecord","instantiateNode","Array","from","values","filter","PoseNodePlayMotion","shell","existing","get","instantiated","instantiate","__callOnAfterDeserializeRecursive","link","consumerNode","runtimePVNodePropertyBindings","_iterator","_createForOfIteratorHelperLoose","_step","done","_step$value","value","producerNode","producerOutputIndex","consumerInputPath","inputPath","warn","linkPoseNode","runtimePVNodePropertyBinding","linkPVNode","push","dependencyEvaluation","DependencyEvaluation","evaluation","_setDependencyEvaluation","pureValueNodeEvaluation","RuntimePVNodeEvaluation","set","consumerPropertyKey","_consumerInputPath$","consumerElementIndex","toString","consumerProperty","isArray","producerRecord","_consumerInputPath$2","RuntimePVNodePlainPropertyBinding","RuntimePVNodeArrayElementPropertyBinding","_export","setters","_virtualInternal253AconstantsJs","DEBUG","_coreIndexJs","_serializationIndexJs","_poseNodeJs","PoseTransformSpaceRequirement","_pureValueNodeJs","_poseNodesPlayMotionJs","execute","_rootPoseNode","_countingPlayMotionNodes","_proto","prototype","bind","context","_this$_rootPoseNode","settle","_this$_rootPoseNode2","reenter","_this$_rootPoseNode3","update","_this$_rootPoseNode4","evaluate","_this$_rootPoseNode$e","_this$_rootPoseNode5","LOCAL","countMotionTime","playMotionNodes","maxWeightedTime","maxWeight","Number","NEGATIVE_INFINITY","iPlayMotionNode","_playMotionNodes$iPla","elapsedMotionTime","lastIndicativeWeight","bindingEvaluations","_bindingEvaluations","_proto2","_iterator2","_step2","_node","_dependency","_outputs","outputCount","_proto3","getDefaultOutput","getOutput","dependency","selfEvaluate","_createClass","key","_consumerNode","_consumerPropertyKey","_producerRecord","_producerOutputIndex","_proto4","_consumerElementIndex","_proto5"],"sources":["../../../../../../../../../../cocos/animation/marionette/pose-graph/instantiation.ts"],"mappings":"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"}