{"version":3,"names":["setters","_coreIndexJs","error","Vec3","_frameworkIndexJs","PhysicsSystem","_bulletCacheJs","BulletCache","_bulletUtilsJs","bullet2CocosVec3","cocos2BulletVec3","_instantiatedJs","bt","btCache","EBulletType","_frameworkPhysicsEnumJs","PhysicsGroup","_shapesBulletShapeJs","BulletShape","_coreUtilsMiscJs","degreesToRadians","_sceneGraphIndexJs","TransformBit","execute","v3_0","v3_1","v3_2","_export","BulletCharacterController","wrappedWorld","_isEnabled","_impl","_comp","_btCollisionFlags","_word3","_dirty","_collisionFilterGroup","DEFAULT","_collisionFilterMask","id","idCounter","instance","physicsWorld","_proto","prototype","onComponentSet","updateScale","initialize","comp","group","mask","collisionMatrix","setWrapper","CCT_CACHE_NAME","cctCollisionShapeImpl","CharacterController_getCollisionShape","impl","onEnable","setDetectCollisions","setOverlapRecovery","addCCT","onDisable","removeCCT","onDestroy","_safe_delete","EBulletTypeCharacterController","delWrapper","onLoad","getPosition","out","CharacterController_getPosition","setPosition","value","syncPhysicsToScene","setContactOffset","CharacterController_setContactOffset","setStepOffset","CharacterController_setStepOffset","setSlopeLimit","CharacterController_setSlopeLimit","CharacterController_setCollision","CharacterController_setOverlapRecovery","onGround","syncSceneToPhysics","node","characterController","hasChangedFlags","SCALE","syncScale","POSITION","add","worldPosition","scaledCenter","subtract","setWorldPosition","move","movement","minDist","elapsedTime","movementBT","BT_V3_0","Vec3_set","x","y","z","CharacterController_move","setGroup","v","getGroup","addGroup","removeGroup","setMask","getMask","addMask","removeMask","updateEventListener","updateNeedEmitCCTEvents","needCollisionEvent","updateDirty","onShapeHitExt","hit","shapePtr","ControllerShapeHit_getHitShape","bulletWorld","item","cctShapeEventDic","get","worldPos","ControllerHit_getHitWorldPos","worldNormal","ControllerHit_getHitWorldNormal","motionDir","ControllerHit_getHitMotionDir","motionLength","ControllerHit_getHitMotionLength","s","getWrapper","TYPE","set","_createClass","key","multiply","center","worldScale"],"sources":["../../../../../../../../../../cocos/physics/bullet/character-controllers/bullet-character-controller.ts"],"mappings":"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"}