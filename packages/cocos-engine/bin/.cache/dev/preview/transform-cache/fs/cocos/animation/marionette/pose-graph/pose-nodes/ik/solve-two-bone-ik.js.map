{"version":3,"names":["DEBUG","_virtualInternal253AconstantsJs","_coreIndexJs","approx","clamp","Quat","Vec3","_twoBoneIkDebuggerJs","debugTwoBoneIKDraw","execute","SANITY_CHECK_ENABLED","TwoBoneIKPositionSanityChecker","_a","_proto","prototype","reset","a","b","c","copy","_dAB","distance","_dBC","check","_b","_c","CHECK_EPSILON","dAB","dBC","_export","solveTwoBoneIK","cacheQuat","cacheHint","cacheBSolved","cacheCSolved","calculateRotationBetweenRays","cacheVec3_1","cacheVec3_2","out","sourceOrigin","sourceDestination","targetOrigin","targetDestination","rotationTo","subtract","normalize","root","middle","end","target","middlePositionHint","debugKey","hint","position","pA","pB","pC","qC","rotation","undefined","bSolved","cSolved","solveTwoBoneIKPositions","qA","multiply","qB","cacheDirAT","cacheDirAB","cacheDirHeightLine","cacheSanityChecker","middleTarget","sanityCheck","dAT","dirAT","chainLength","scaleAndAdd","cosá¸‚AT","dirAB","dirHeightLine","projectOnPlane","dAD","hSqr","h","Math","sqrt"],"sources":["../../../../../../../../../../../../cocos/animation/marionette/pose-graph/pose-nodes/ik/solve-two-bone-ik.ts"],"mappings":";;;;;;;;;MAASA,KAAK,GAAAC,+BAAA,CAALD,KAAK;IAAA,aAAAE,YAAA;MACLC,MAAM,GAAAD,YAAA,CAANC,MAAM;MAAEC,KAAK,GAAAF,YAAA,CAALE,KAAK;MAAEC,IAAI,GAAAH,YAAA,CAAJG,IAAI;MAAEC,IAAI,GAAAJ,YAAA,CAAJI,IAAI;IAAA,aAAAC,oBAAA;MAEzBC,kBAAkB,GAAAD,oBAAA,CAAlBC,kBAAkB;IAAA;IAAAC,OAAA,WAAAA,CAAA;MAErBC,oBAAoB,GAAGV,KAAK;MAE5BW,8BAA8B;QAAA,SAAAA,+BAAA;UAAA,KA6BxBC,EAAE,GAAG,IAAIN,IAAI,CAAC,CAAC;QAAA;QAAA,IAAAO,MAAA,GAAAF,8BAAA,CAAAG,SAAA;QAAAD,MAAA,CA5BhBE,KAAK,GAAZ,SAAAA,MAAcC,CAAiB,EAAEC,CAAiB,EAAEC,CAAiB,EAAQ;UACzEZ,IAAI,CAACa,IAAI,CAAC,IAAI,CAACP,EAAE,EAAEI,CAAC,CAAC;UACrB,IAAI,CAACI,IAAI,GAAGd,IAAI,CAACe,QAAQ,CAACL,CAAC,EAAEC,CAAC,CAAC;UAC/B,IAAI,CAACK,IAAI,GAAGhB,IAAI,CAACe,QAAQ,CAACJ,CAAC,EAAEC,CAAC,CAAC;QACnC,CAAC;QAAAL,MAAA,CAEMU,KAAK,GAAZ,SAAAA,MAAcX,EAAkB,EAAEY,EAAkB,EAAEC,EAAkB,EAAW;UAC/E,IAAMC,aAAa,GAAG,IAAI;UAC1B,IAAMC,GAAG,GAAGrB,IAAI,CAACe,QAAQ,CAACT,EAAE,EAAEY,EAAE,CAAC;UACjC,IAAMI,GAAG,GAAGtB,IAAI,CAACe,QAAQ,CAACG,EAAE,EAAEC,EAAE,CAAC;UACjC,IAAI,CAACtB,MAAM,CAACG,IAAI,CAACe,QAAQ,CAACT,EAAE,EAAE,IAAI,CAACA,EAAE,CAAC,EAAE,GAAG,EAAEc,aAAa,CAAC,EAAE;YACzD;YACA;YACA,OAAO,KAAK;UAChB;UACA,IAAI,CAACvB,MAAM,CAACwB,GAAG,EAAE,IAAI,CAACP,IAAI,EAAEM,aAAa,CAAC,EAAE;YACxC;YACA;YACA,OAAO,KAAK;UAChB;UACA,IAAI,CAACvB,MAAM,CAACyB,GAAG,EAAE,IAAI,CAACN,IAAI,EAAEI,aAAa,CAAC,EAAE;YACxC;YACA;YACA,OAAO,KAAK;UAChB;UACA,OAAO,IAAI;QACf,CAAC;QAAA,OAAAf,8BAAA;MAAA;MAOL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MARAkB,OAAA,mBASaC,cAAc,GAAI,YAA6I;QACxK,IAAMC,SAAS,GAAG,IAAI1B,IAAI,CAAC,CAAC;QAC5B,IAAM2B,SAAS,GAAG,IAAI1B,IAAI,CAAC,CAAC;QAC5B,IAAM2B,YAAY,GAAG,IAAI3B,IAAI,CAAC,CAAC;QAC/B,IAAM4B,YAAY,GAAG,IAAI5B,IAAI,CAAC,CAAC;QAE/B,IAAM6B,4BAA4B,GAAI,YAA6J;UAC/L,IAAMC,WAAW,GAAG,IAAI9B,IAAI,CAAC,CAAC;UAC9B,IAAM+B,WAAW,GAAG,IAAI/B,IAAI,CAAC,CAAC;UAC9B,OAAO,UACHgC,GAAS,EACTC,YAA4B,EAAEC,iBAAiC,EAC/DC,YAA4B,EAAEC;UAClC;UAAA,EACW;YACP,OAAOrC,IAAI,CAACsC,UAAU,CAClBL,GAAG,EACHhC,IAAI,CAACsC,QAAQ,CAACR,WAAW,EAAEI,iBAAiB,EAAED,YAAY,CAAC,CAACM,SAAS,CAAC,CAAC,EACvEvC,IAAI,CAACsC,QAAQ,CAACP,WAAW,EAAEK,iBAAiB,EAAED,YAAY,CAAC,CAACI,SAAS,CAAC,CAC1E,CAAC;UACL,CAAC;QACL,CAAC,CAAE,CAAC;QAEJ,OAAO,UACHC,IAAe,EACfC,MAAiB,EACjBC,GAAc,EACdC,MAAY,EACZC,kBAAyB,EACzBC,QAA8B,EACvB;UACP,IAAMC,IAAI,GAAG9C,IAAI,CAACa,IAAI,CAACa,SAAS,EAAEkB,kBAAkB,aAAlBA,kBAAkB,cAAlBA,kBAAkB,GAAIH,MAAM,CAACM,QAAQ,CAAC;UAExE,IAAMC,EAAE,GAAGR,IAAI,CAACO,QAAQ;UACxB,IAAME,EAAE,GAAGR,MAAM,CAACM,QAAQ;UAC1B,IAAMG,EAAE,GAAGR,GAAG,CAACK,QAAQ;UACvB,IAAMI,EAAE,GAAGT,GAAG,CAACU,QAAQ;UAEvB,IAAI1D,KAAK,EAAE;YACP,IAAI,OAAOmD,QAAQ,KAAKQ,SAAS,EAAE;cAC/BnD,kBAAkB,CAAC2C,QAAQ,EAAEG,EAAE,EAAEC,EAAE,EAAEC,EAAE,CAAC;YAC5C;UACJ;UAEA,IAAMI,OAAO,GAAG3B,YAAY;UAC5B,IAAM4B,OAAO,GAAG3B,YAAY;UAC5B4B,uBAAuB,CACnBR,EAAE,EACFC,EAAE,EACFC,EAAE,EACFP,MAAM,EACNG,IAAI,EACJQ,OAAO,EACPC,OACJ,CAAC;UAED,IAAME,EAAE,GAAG5B,4BAA4B,CACnCJ,SAAS,EACTuB,EAAE,EAAEC,EAAE,EACND,EAAE,EAAEM,OACR,CAAC;UACDvD,IAAI,CAAC2D,QAAQ,CAACD,EAAE,EAAEA,EAAE,EAAEjB,IAAI,CAACY,QAAQ,CAAC;UACpCZ,IAAI,CAACY,QAAQ,GAAGK,EAAE;UAElB,IAAME,EAAE,GAAG9B,4BAA4B,CACnCJ,SAAS,EACTwB,EAAE,EAAEC,EAAE,EACNI,OAAO,EAAEC,OACb,CAAC;UACDxD,IAAI,CAAC2D,QAAQ,CAACC,EAAE,EAAEA,EAAE,EAAElB,MAAM,CAACW,QAAQ,CAAC;UACtCX,MAAM,CAACW,QAAQ,GAAGO,EAAE;UACpBlB,MAAM,CAACM,QAAQ,GAAGO,OAAO;UAEzBZ,GAAG,CAACK,QAAQ,GAAGQ,OAAO;QAC1B,CAAC;MACL,CAAC,CAAE,CAAC;MAAAhC,OAAA,4BAESiC,uBAAuB,GAAI,YAA6J;QACjM,IAAMI,UAAU,GAAG,IAAI5D,IAAI,CAAC,CAAC;QAC7B,IAAM6D,UAAU,GAAG,IAAI7D,IAAI,CAAC,CAAC;QAC7B,IAAM8D,kBAAkB,GAAG,IAAI9D,IAAI,CAAC,CAAC;QACrC,IAAM+D,kBAAkB,GAAG3D,oBAAoB,GACzC,IAAIC,8BAA8B,CAAC,CAAC,GACpCgD,SAAS;QAEf,OAAO,UACH3C,CAAiB,EACjBC,CAAiB,EACjBC,CAAiB,EACjB+B,MAAsB,EACtBqB,YAA4B,EAC5BV,OAAa,EACbC,OAAa,EACN;UACP,IAAMU,WAAW,GAAGF,kBAAkB,GAC/B,YAAqB;YACpBA,kBAAkB,aAAlBA,kBAAkB,uBAAlBA,kBAAkB,CAAEtD,KAAK,CAACC,CAAC,EAAEC,CAAC,EAAEC,CAAC,CAAC;YAClC,OAAO;cAAA,OAAemD,kBAAkB,CAAC9C,KAAK,CAACP,CAAC,EAAE4C,OAAO,EAAEC,OAAO,CAAC;YAAA;UACvE,CAAC,CAAE,CAAC,GACFF,SAAS;UAEf,IAAMhC,GAAG,GAAGrB,IAAI,CAACe,QAAQ,CAACL,CAAC,EAAEC,CAAC,CAAC;UAC/B,IAAMW,GAAG,GAAGtB,IAAI,CAACe,QAAQ,CAACJ,CAAC,EAAEC,CAAC,CAAC;UAC/B,IAAMsD,GAAG,GAAGlE,IAAI,CAACe,QAAQ,CAACL,CAAC,EAAEiC,MAAM,CAAC;UAEpC,IAAMwB,KAAK,GAAGnE,IAAI,CAACsC,QAAQ,CAACsB,UAAU,EAAEjB,MAAM,EAAEjC,CAAC,CAAC;UAClDyD,KAAK,CAAC5B,SAAS,CAAC,CAAC;UAEjB,IAAM6B,WAAW,GAAG/C,GAAG,GAAGC,GAAG;UAC7B,IAAI4C,GAAG,IAAIE,WAAW,EAAE;YACpB;YACApE,IAAI,CAACqE,WAAW,CAACf,OAAO,EAAE5C,CAAC,EAAEyD,KAAK,EAAE9C,GAAG,CAAC;YACxCrB,IAAI,CAACqE,WAAW,CAACd,OAAO,EAAE7C,CAAC,EAAEyD,KAAK,EAAEC,WAAW,CAAC;YAChDH,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAG,CAAC;YACf;UACJ;;UAEA;UACA;UACAjE,IAAI,CAACa,IAAI,CAAC0C,OAAO,EAAEZ,MAAM,CAAC;UAC1B;UACA,IAAM2B,MAAM,GAAGxE,KAAK,CAChB,CAACuB,GAAG,GAAGA,GAAG,GAAG6C,GAAG,GAAGA,GAAG,GAAG5C,GAAG,GAAGA,GAAG,KAAK,CAAC,GAAGD,GAAG,GAAG6C,GAAG,CAAC,EACrD,CAAC,GAAG,EACJ,GACJ,CAAC;UACD;UACA;UACA,IAAMK,KAAK,GAAGvE,IAAI,CAACsC,QAAQ,CAACuB,UAAU,EAAEG,YAAY,EAAEtD,CAAC,CAAC;UACxD,IAAM8D,aAAa,GAAGxE,IAAI,CAACyE,cAAc,CAACX,kBAAkB,EAAES,KAAK,EAAEJ,KAAK,CAAC;UAC3EK,aAAa,CAACjC,SAAS,CAAC,CAAC;UACzB,IAAMmC,GAAG,GAAGrD,GAAG,GAAGiD,MAAM;UACxB,IAAMK,IAAI,GAAGtD,GAAG,GAAGA,GAAG,GAAGqD,GAAG,GAAGA,GAAG;UAClC,IAAIC,IAAI,GAAG,CAAC,EAAE;YACV;YACA;YACA;UACJ;UACA,IAAMC,CAAC,GAAGC,IAAI,CAACC,IAAI,CAACH,IAAI,CAAC;UACzB3E,IAAI,CAACqE,WAAW,CAACf,OAAO,EAAE5C,CAAC,EAAEyD,KAAK,EAAEO,GAAG,CAAC;UACxC1E,IAAI,CAACqE,WAAW,CAACf,OAAO,EAAEA,OAAO,EAAEkB,aAAa,EAAEI,CAAC,CAAC;UACpDX,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAG,CAAC;QACnB,CAAC;MACL,CAAC,CAAE,CAAC;IAAA;EAAA;AAAA"}