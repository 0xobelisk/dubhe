{"version":3,"names":["setters","_virtualInternal253AconstantsJs","DEBUG","_assetAssetsMaterialJs","Material","_coreIndexJs","Color","Mat4","Vec3","Vec2","Enum","assert","geometry","cclegacy","execute","_export","ShadowSize","Low_256x256","Medium_512x512","High_1024x1024","Ultra_2048x2048","ShadowType","Planar","ShadowMap","PCFType","HARD","SOFT","SOFT_2X","SOFT_4X","CSMLevel","LEVEL_1","LEVEL_2","LEVEL_3","LEVEL_4","CSMOptimizationMode","NONE","RemoveDuplicates","DisableRotationFix","SHADOW_TYPE_NONE","Shadows","fixedSphere","Sphere","maxReceived","_matLight","_material","_instancingMaterial","_enabled","_type","_distance","_planeBias","_normal","_shadowColor","_size","_shadowMapDirty","_proto","prototype","getPlanarShader","patches","initialize","effectName","passes","length","getShaderVariant","shadowsInfo","enabled","type","normal","planeDirection","distance","planeHeight","planeBias","shadowColor","shadowMapSize","x","size","set","activate","_updatePlanarInfo","root","director","pipeline","macros","CC_SHADOW_TYPE","onGlobalPipelineStateChanged","destroy","_createClass","key","get","val","copy","color","MAX_FAR","COEFFICIENT_OF_EXPANSION","Math","sqrt"],"sources":["../../../../../../../../../cocos/render-scene/scene/shadows.ts"],"mappings":"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"}