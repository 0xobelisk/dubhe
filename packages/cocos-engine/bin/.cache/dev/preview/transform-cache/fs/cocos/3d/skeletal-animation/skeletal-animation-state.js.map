{"version":3,"names":["setters","_virtualInternal253AconstantsJs","JSB","_coreIndexJs","Mat4","Quat","Vec3","cclegacy","_animationAnimationStateJs","AnimationState","_skeletalAnimationDataHubJs","SkelAnimDataHub","execute","m4_1","m4_2","_export","SkeletalAnimationState","_AnimationState","_inheritsLoose","clip","name","_this","call","_frames","_bakedDuration","_animInfo","_sockets","_animInfoMgr","_parent","_curvesInited","director","root","dataPoolManager","jointAnimationInfo","_proto","prototype","initialize","_curveLoaded","getComponent","baked","useBakedAnimation","_doNotCreateEval","_SkelAnimDataHub$getO","getOrExtract","frames","samples","getData","uuid","setUseBaked","onPlay","_this2","switchClip","users","getUsers","forEach","user","uploadAnimation","useBaked","_sampleCurves","_sampleCurvesBaked","duration","_targetNode","rebuildSocketCurves","sockets","length","i","socket","targetNode","getChildByPath","path","target","clipData","animPath","source","joints","animNode","downstream","idx","lastIndexOf","substring","identity","fromRTS","rotation","position","scale","multiply","parent","curveData","transforms","f","mat","tfm","pos","rot","toRTS","push","time","ratio","info","currentClip","data","curFrame","dirty","dirtyForJSB","_this$_sockets$i","_frames$curFrame","setRTS"],"sources":["../../../../../../../../../cocos/3d/skeletal-animation/skeletal-animation-state.ts"],"mappings":"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"}