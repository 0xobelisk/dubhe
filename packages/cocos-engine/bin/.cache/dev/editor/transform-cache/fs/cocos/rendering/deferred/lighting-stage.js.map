{"version":3,"names":["ccclass","_coreDataDecoratorsIndexJs","displayOrder","type","serializable","_renderSceneSceneLightJs","LightType","_defineJs","UBODeferredLight","SetIndex","UBOForwardLight","UBOLocal","_passPhaseJs","getPhaseID","_gfxIndexJs","Color","Rect","BufferUsageBit","MemoryUsageBit","BufferInfo","BufferViewInfo","DescriptorSetInfo","ClearFlagBit","_renderStageJs","RenderStage","_enumJs","DeferredStagePriority","_planarShadowQueueJs","PlanarShadowQueue","_assetAssetsMaterialJs","Material","_pipelineStateManagerJs","PipelineStateManager","_coreGeometryIndexJs","intersect","Sphere","_coreMathIndexJs","Vec3","Vec4","_renderQueueJs","renderQueueClearFunc","convertRenderQueue","renderQueueSortFunc","_pipelineSerializationJs","RenderQueueDesc","_uiPhaseJs","UIPhase","_coreGeometryAabbJs","AABB","_coreIndexJs","geometry","execute","_v3","_rangedDirLightBoundingBox","_tmpBoundingBox","colors","_export","LightingStage","_dec","_dec2","_dec3","_dec4","_dec5","_class","_class2","_class3","constructor","_deferredLitsBufs","_maxDeferredLights","LIGHTS_PER_PASS","_lightBufferData","_lightMeterScale","_descriptorSet","_descriptorSetLayout","_renderArea","_uiPhase","_deferredMaterial","_initializer","renderQueues","_initializer2","_phaseID","_renderQueues","initialize","info","gatherLights","camera","pipeline","_pipeline","cmdBuff","commandBuffers","sphereLights","scene","spotLights","pointLights","rangedDirLights","_sphere","create","_vec4Array","Float32Array","exposure","idx","elementLen","length","fieldLen","i","light","set","position","x","y","z","range","sphereFrustum","frustum","toArray","SPHERE","color","useColorTemperature","finalColor","pipelineSceneData","isHDR","luminance","size","SPOT","spotAngle","direction","POINT","transform","node","getWorldMatrix","aabbFrustum","RANGED_DIRECTIONAL","illuminance","right","scale","offset","updateBuffer","_createStageDescriptor","pass","device","totalSize","BYTES_PER_ELEMENT","Math","ceil","capabilities","uboOffsetAlignment","createBuffer","UNIFORM","TRANSFER_DST","HOST","DEVICE","deferredLitsBufView","createDescriptorSet","localSetLayout","bindBuffer","BINDING","_localUBO","SIZE","activate","flow","_planarQueue","deferredLightingMaterial","destroy","_this$_deferredLitsBu","render","_camera$geometryRende","sceneData","renderObjects","gatherShadowPasses","generateRenderArea","deferredData","getPipelineRenderData","lightingMat","passes","shader","getShaderVariant","descriptorSet","bindTexture","gbufferRenderTargets","bindSampler","sampler","outputDepth","update","clearFlag","COLOR","clearColor","w","framebuffer","outputFrameBuffer","renderPass","pipelineUBO","updateShadowUBO","beginRenderPass","clearDepth","clearStencil","setScissor","generateScissor","setViewport","generateViewport","bindDescriptorSet","GLOBAL","inputAssembler","quadIAOffscreen","pso","getOrCreatePipelineState","bindPipelineState","MATERIAL","LOCAL","bindInputAssembler","draw","forEach","m","p","k","ro","subModels","model","subModel","phase","insertRenderPass","recordCommandBuffer","geometryRenderer","endRenderPass","initInfo","name","priority","LIGHTING","tag","_applyDecoratedInitializer","prototype"],"sources":["file:///Users/henryliu/obelisk/fish-game/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/rendering/deferred/lighting-stage.ts"],"mappings":"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"}