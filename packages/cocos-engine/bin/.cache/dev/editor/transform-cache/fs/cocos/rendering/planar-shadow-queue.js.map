{"version":3,"names":["PlanarShadowQueue","_ab","_phaseID","_defineProperty","obj","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","getPlanarShadowPassIndex","subModel","passes","r","cclegacy","rendering","isEnableEffect","getPhaseID","getPassID","k","length","enableEffectImport","phase","phaseID","_export","setters","_coreIndexJs","geometry","_defineJs","SetIndex","_pipelineStateManagerJs","PipelineStateManager","_renderInstancedQueueJs","RenderInstancedQueue","_renderSceneSceneShadowsJs","ShadowType","_sceneGraphLayersJs","Layers","_renderSceneCorePassJs","BatchingSchemes","_passPhaseJs","execute","AABB","constructor","pipeline","_subModelArray","_shaderArray","_passArray","_castModels","_instancedQueue","_pipeline","clear","gatherShadowPasses","camera","cmdBuff","pipelineSceneData","shadows","enabled","type","Planar","normal","scene","frustum","shadowVisible","visibility","BitMask","DEFAULT","mainLight","models","i","model","isCulledByLod","node","castShadow","layer","push","worldBounds","transform","matLight","intersect","aabbFrustum","subModels","j","shadowPassIdx","planarShader","getPlanarShader","patches","material","pass","batchingScheme","INSTANCING","buffer","getInstancedBuffer","merge","queue","add","shader","shaders","uploadBuffers","recordCommandBuffer","device","renderPass","ia","inputAssembler","pso","getOrCreatePipelineState","descriptorSet","bindPipelineState","bindDescriptorSet","MATERIAL","LOCAL","bindInputAssembler","draw"],"sources":["file:///Users/henryliu/obelisk/fish-game/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/rendering/planar-shadow-queue.ts"],"mappings":";;;iJAmDaA,iBAAiB,EAAAC,GAAA,EAAAC,QAAA;EAAA,SAAAC,gBAAAC,GAAA,EAAAC,GAAA,EAAAC,KAAA,IAAAD,GAAA,GAAAE,cAAA,CAAAF,GAAA,OAAAA,GAAA,IAAAD,GAAA,IAAAI,MAAA,CAAAC,cAAA,CAAAL,GAAA,EAAAC,GAAA,IAAAC,KAAA,EAAAA,KAAA,EAAAI,UAAA,QAAAC,YAAA,QAAAC,QAAA,oBAAAR,GAAA,CAAAC,GAAA,IAAAC,KAAA,WAAAF,GAAA;EAAA,SAAAG,eAAAM,GAAA,QAAAR,GAAA,GAAAS,YAAA,CAAAD,GAAA,2BAAAR,GAAA,gBAAAA,GAAA,GAAAU,MAAA,CAAAV,GAAA;EAAA,SAAAS,aAAAE,KAAA,EAAAC,IAAA,eAAAD,KAAA,iBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,OAAAF,IAAA,KAAAG,SAAA,QAAAC,GAAA,GAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,EAAAC,IAAA,2BAAAK,GAAA,sBAAAA,GAAA,YAAAE,SAAA,4DAAAP,IAAA,gBAAAF,MAAA,GAAAU,MAAA,EAAAT,KAAA,KAnD9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAgBA,SAASU,wBAAwBA,CAAEC,QAAkB,EAAU;IAC3D,MAAMC,MAAM,GAAGD,QAAQ,CAACC,MAAM;IAC9B,MAAMC,CAAC,GAAGC,QAAQ,CAACC,SAAS;IAC5B,IAAIC,cAAc,CAAC,CAAC,EAAE9B,QAAQ,GAAG2B,CAAC,CAACI,UAAU,CAACJ,CAAC,CAACK,SAAS,CAAC,SAAS,CAAC,EAAE,eAAe,CAAC;IACtF,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGP,MAAM,CAACQ,MAAM,EAAED,CAAC,EAAE,EAAE;MACpC,IAAK,CAAC,CAACN,CAAC,IAAI,CAACA,CAAC,CAACQ,kBAAkB,KAAKT,MAAM,CAACO,CAAC,CAAC,CAACG,KAAK,KAAKpC,QAAQ,IAC9D8B,cAAc,CAAC,CAAC,IAAIJ,MAAM,CAACO,CAAC,CAAC,CAACI,OAAO,KAAKrC,QAAS,EAAE;QACrD,OAAOiC,CAAC;MACZ;IACJ;IACA,OAAO,CAAC,CAAC;EACb;EAACK,OAAA;EAAA;IAAAC,OAAA,aAAAC,YAAA;MAzBQZ,QAAQ,GAAAY,YAAA,CAARZ,QAAQ;MAAEa,QAAQ,GAAAD,YAAA,CAARC,QAAQ;IAAA,aAAAC,SAAA;MAClBZ,cAAc,GAAAY,SAAA,CAAdZ,cAAc;MAAEa,QAAQ,GAAAD,SAAA,CAARC,QAAQ;IAAA,aAAAC,uBAAA;MAExBC,oBAAoB,GAAAD,uBAAA,CAApBC,oBAAoB;IAAA,aAAAC,uBAAA;MAEpBC,oBAAoB,GAAAD,uBAAA,CAApBC,oBAAoB;IAAA,aAAAC,0BAAA;MACpBC,UAAU,GAAAD,0BAAA,CAAVC,UAAU;IAAA,aAAAC,mBAAA;MACVC,MAAM,GAAAD,mBAAA,CAANC,MAAM;IAAA,aAAAC,sBAAA;MAENC,eAAe,GAAAD,sBAAA,CAAfC,eAAe;IAAA,aAAAC,YAAA;MACfvB,UAAU,GAAAuB,YAAA,CAAVvB,UAAU;IAAA;IAAAwB,OAAA,WAAAA,CAAA;MAEbxD,GAAG,GAAG,IAAI0C,QAAQ,CAACe,IAAI,CAAC,CAAC;MAC3BxD,QAAQ,GAAG+B,UAAU,CAAC,eAAe,CAAC;MAAAO,OAAA,sBAc7BxC,iBAAiB,GAAvB,MAAMA,iBAAiB,CAAC;QAQ3B2D,WAAWA,CAAEC,QAAyB,EAAE;UAAA,KAPhCC,cAAc,GAAe,EAAE;UAAA,KAC/BC,YAAY,GAAa,EAAE;UAAA,KAC3BC,UAAU,GAAW,EAAE;UAAA,KACvBC,WAAW,GAAY,EAAE;UAAA,KACzBC,eAAe,GAAG,IAAIhB,oBAAoB,CAAC,CAAC;UAAA,KAC5CiB,SAAS;UAGb,IAAI,CAACA,SAAS,GAAGN,QAAQ;QAC7B;;QAEA;AACJ;AACA;AACA;AACA;AACA;QACWO,KAAKA,CAAA,EAAU;UAClB,IAAI,CAACN,cAAc,CAACzB,MAAM,GAAG,CAAC;UAC9B,IAAI,CAAC0B,YAAY,CAAC1B,MAAM,GAAG,CAAC;UAC5B,IAAI,CAAC2B,UAAU,CAAC3B,MAAM,GAAG,CAAC;UAC1B,IAAI,CAAC6B,eAAe,CAACE,KAAK,CAAC,CAAC;UAC5B,IAAI,CAACH,WAAW,CAAC5B,MAAM,GAAG,CAAC;QAC/B;QAEOgC,kBAAkBA,CAAEC,MAAc,EAAEC,OAAsB,EAAQ;UACrE,IAAI,CAACH,KAAK,CAAC,CAAC;UACZ,MAAMI,iBAAiB,GAAG,IAAI,CAACL,SAAS,CAACK,iBAAiB;UAC1D,MAAMC,OAAO,GAAGD,iBAAiB,CAACC,OAAO;UACzC,IAAI,CAACA,OAAO,CAACC,OAAO,IAAID,OAAO,CAACE,IAAI,KAAKvB,UAAU,CAACwB,MAAM,IAAIH,OAAO,CAACI,MAAM,CAACxC,MAAM,CAAC,CAAC,GAAG,QAAQ,EAAE;YAAE;UAAQ;UAE5G,MAAMyC,KAAK,GAAGR,MAAM,CAACQ,KAAM;UAC3B,MAAMC,OAAO,GAAGT,MAAM,CAACS,OAAO;UAC9B,MAAMC,aAAa,GAAI,CAACV,MAAM,CAACW,UAAU,GAAG3B,MAAM,CAAC4B,OAAO,CAACC,OAAO,MAAM,CAAC;UACzE,IAAI,CAACL,KAAK,CAACM,SAAS,IAAI,CAACJ,aAAa,EAAE;YAAE;UAAQ;UAElD,MAAMK,MAAM,GAAGP,KAAK,CAACO,MAAM;UAC3B,MAAMJ,UAAU,GAAGX,MAAM,CAACW,UAAU;UACpC,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,MAAM,CAAChD,MAAM,EAAEiD,CAAC,EAAE,EAAE;YACpC,MAAMC,KAAK,GAAGF,MAAM,CAACC,CAAC,CAAC;YACvB,IAAIR,KAAK,CAACU,aAAa,CAAClB,MAAM,EAAEiB,KAAK,CAAC,EAAE;cACpC;YACJ;YACA,IAAIA,KAAK,CAACb,OAAO,IAAIa,KAAK,CAACE,IAAI,IAAIF,KAAK,CAACG,UAAU,IAC3CH,KAAK,CAACE,IAAI,IAAK,CAACR,UAAU,GAAGM,KAAK,CAACE,IAAI,CAACE,KAAK,MAAMJ,KAAK,CAACE,IAAI,CAACE,KAAO,EAAE;cAC3E,IAAI,CAAC1B,WAAW,CAAC2B,IAAI,CAACL,KAAK,CAAC;YAChC;UACJ;UAEA,KAAK,IAAID,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACrB,WAAW,CAAC5B,MAAM,EAAEiD,CAAC,EAAE,EAAE;YAC9C,MAAMC,KAAK,GAAG,IAAI,CAACtB,WAAW,CAACqB,CAAC,CAAC;YACjC,IAAIC,KAAK,CAACM,WAAW,EAAE;cACnBjD,QAAQ,CAACe,IAAI,CAACmC,SAAS,CAAC5F,GAAG,EAAEqF,KAAK,CAACM,WAAW,EAAEpB,OAAO,CAACsB,QAAQ,CAAC;cACjE,IAAI,CAACnD,QAAQ,CAACoD,SAAS,CAACC,WAAW,CAAC/F,GAAG,EAAE6E,OAAO,CAAC,EAAE;gBAAE;cAAU;YACnE;YAEA,MAAMmB,SAAS,GAAGX,KAAK,CAACW,SAAS;YACjC,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,SAAS,CAAC7D,MAAM,EAAE8D,CAAC,EAAE,EAAE;cACvC,MAAMvE,QAAQ,GAAGsE,SAAS,CAACC,CAAC,CAAC;cAC7B,MAAMC,aAAa,GAAGzE,wBAAwB,CAACC,QAAQ,CAAC;cACxD,IAAIwE,aAAa,GAAG,CAAC,EAAE;gBACnB,IAAI,CAACtC,cAAc,CAAC8B,IAAI,CAAChE,QAAQ,CAAC;gBAClC,MAAMyE,YAAY,GAAG5B,OAAO,CAAC6B,eAAe,CAAC1E,QAAQ,CAAC2E,OAAO,CAAC;gBAC9D,IAAI,CAACF,YAAY,EAAE;kBAAE;gBAAU;gBAC/B,IAAI,CAACtC,YAAY,CAAC6B,IAAI,CAACS,YAAY,CAAC;gBACpC,IAAI,CAACrC,UAAU,CAAC4B,IAAI,CAACnB,OAAO,CAAC+B,QAAQ,CAAC3E,MAAM,CAAC,CAAC,CAAC,CAAC;gBAChD;cACJ;cAEA,MAAM4E,IAAI,GAAG7E,QAAQ,CAACC,MAAM,CAACuE,aAAa,CAAC;cAC3C,MAAMM,cAAc,GAAGD,IAAI,CAACC,cAAc;cAC1C,IAAIA,cAAc,KAAKlD,eAAe,CAACmD,UAAU,EAAE;gBAC/C,MAAMC,MAAM,GAAGH,IAAI,CAACI,kBAAkB,CAAC,CAAC;gBACxCD,MAAM,CAACE,KAAK,CAAClF,QAAQ,EAAEwE,aAAa,CAAC;gBACrC,IAAI,CAAClC,eAAe,CAAC6C,KAAK,CAACC,GAAG,CAACJ,MAAM,CAAC;cAC1C,CAAC,MAAM;gBACH,MAAMK,MAAM,GAAGrF,QAAQ,CAACsF,OAAO,CAACd,aAAa,CAAC;gBAC9C,IAAI,CAACtC,cAAc,CAAC8B,IAAI,CAAChE,QAAQ,CAAC;gBAClC,IAAIqF,MAAM,EAAE,IAAI,CAAClD,YAAY,CAAC6B,IAAI,CAACqB,MAAM,CAAC;gBAC1C,IAAI,CAACjD,UAAU,CAAC4B,IAAI,CAACa,IAAI,CAAC;cAC9B;YACJ;UACJ;UACA,IAAI,CAACvC,eAAe,CAACiD,aAAa,CAAC5C,OAAO,CAAC;QAC/C;QAEO6C,mBAAmBA,CAAEC,MAAc,EAAEC,UAAsB,EAAE/C,OAAsB,EAAQ;UAC9F,MAAME,OAAO,GAAG,IAAI,CAACN,SAAS,CAACK,iBAAiB,CAACC,OAAO;UAExD,IAAI,CAACA,OAAO,CAACC,OAAO,IAAID,OAAO,CAACE,IAAI,KAAKvB,UAAU,CAACwB,MAAM,EAAE;YAAE;UAAQ;UACtE,IAAI,CAACV,eAAe,CAACkD,mBAAmB,CAACC,MAAM,EAAEC,UAAU,EAAE/C,OAAO,CAAC;UAErE,KAAK,IAAIe,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACxB,cAAc,CAACzB,MAAM,EAAE,EAAEiD,CAAC,EAAE;YACjD,MAAM1D,QAAQ,GAAG,IAAI,CAACkC,cAAc,CAACwB,CAAC,CAAC;YACvC,MAAM2B,MAAM,GAAG,IAAI,CAAClD,YAAY,CAACuB,CAAC,CAAC;YACnC,MAAMmB,IAAI,GAAG,IAAI,CAACzC,UAAU,CAACsB,CAAC,CAAC;YAC/B,MAAMiC,EAAE,GAAG3F,QAAQ,CAAC4F,cAAc;YAClC,MAAMC,GAAG,GAAGzE,oBAAoB,CAAC0E,wBAAwB,CAACL,MAAM,EAAEZ,IAAI,EAAEQ,MAAM,EAAEK,UAAU,EAAEC,EAAE,CAAC;YAC/F,MAAMI,aAAa,GAAGlB,IAAI,CAACkB,aAAa;YAExCpD,OAAO,CAACqD,iBAAiB,CAACH,GAAG,CAAC;YAC9BlD,OAAO,CAACsD,iBAAiB,CAAC/E,QAAQ,CAACgF,QAAQ,EAAEH,aAAa,CAAC;YAC3DpD,OAAO,CAACsD,iBAAiB,CAAC/E,QAAQ,CAACiF,KAAK,EAAEnG,QAAQ,CAAC+F,aAAa,CAAC;YACjEpD,OAAO,CAACyD,kBAAkB,CAACT,EAAE,CAAC;YAC9BhD,OAAO,CAAC0D,IAAI,CAACV,EAAE,CAAC;UACpB;QACJ;MACJ,CAAC;IAAA;EAAA;AAAA"}