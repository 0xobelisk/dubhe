{"version":3,"names":["EvaluationRecord","ItemEvaluationRecord","_dec","_dec2","_class","_class2","_initializer","_initializer2","ZERO_ALTERING_DURATION_THRESHOLD","PoseNodeChoosePoseBase","_defineProperty","obj","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","_applyDecoratedInitializer","target","property","decorators","initializer","slice","reverse","reduce","decoratedInitializer","decorator","_initializerWarningHelper","descriptor","context","Error","setters","_virtualInternal253AconstantsJs","DEBUG","_coreDataDecoratorsIndexJs","ccclass","serializable","_corePoseJs","blendPoseInto","_defineJs","CLASS_NAME_PREFIX_ANIM","_poseNodeJs","PoseNode","PoseTransformSpaceRequirement","_animationGraphContextJs","AnimationGraphUpdateContextGenerator","_decoratorNodeJs","poseGraphNodeHide","_coreIndexJs","assertIsTrue","lerp","_utilsJs","isIgnorableWeight","execute","_export","constructor","initialChoiceCount","_poses","_fadeInDurations","_updateContextGenerator","_evaluationRecord","length","fill","bind","pose","evaluationRecord","getChosenIndex","settle","reenter","doUpdate","poses","update","deltaTime","allWeightsAreZero","nPoses","items","iPose","weight","itemUpdateContext","generate","indicativeWeight","doEvaluate","spaceRequirement","LOCAL","finalPose","sumWeight","iInputPose","_poses$iInputPose","inputPoseWeight","inputPose","evaluate","t","popPose","evaluateDefaultPose","prototype","itemCount","initialChosenIndex","_items","_chosenPoseIndex","_elapsedTransitionTime","_blendingDuration","Array","from","selfSourceWeight","selfTargetWeight","newChoseIndex","fadeInDurations","_checkAlternation","elapsedTransitionTime","blendingDuration","newUniformTransformRatio","remain","item","selfWeight","every","oldChoseIndex","newFadeInDuration","Math","max","oldUniformTransitionRatio"],"sources":["file:///Users/henryliu/obelisk/fish-game/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/animation/marionette/pose-graph/pose-nodes/choose-pose/choose-pose-base.ts"],"mappings":";;;oNA6IMA,gBAAgB,EAwJhBC,oBAAoB,EAAAC,IAAA,EAAAC,KAAA,EAAAC,MAAA,EAAAC,OAAA,EAAAC,YAAA,EAAAC,aAAA,EAAAC,gCAAA,EAAAC,sBAAA;EAAA,SAAAC,gBAAAC,GAAA,EAAAC,GAAA,EAAAC,KAAA,IAAAD,GAAA,GAAAE,cAAA,CAAAF,GAAA,OAAAA,GAAA,IAAAD,GAAA,IAAAI,MAAA,CAAAC,cAAA,CAAAL,GAAA,EAAAC,GAAA,IAAAC,KAAA,EAAAA,KAAA,EAAAI,UAAA,QAAAC,YAAA,QAAAC,QAAA,oBAAAR,GAAA,CAAAC,GAAA,IAAAC,KAAA,WAAAF,GAAA;EAAA,SAAAG,eAAAM,GAAA,QAAAR,GAAA,GAAAS,YAAA,CAAAD,GAAA,2BAAAR,GAAA,gBAAAA,GAAA,GAAAU,MAAA,CAAAV,GAAA;EAAA,SAAAS,aAAAE,KAAA,EAAAC,IAAA,eAAAD,KAAA,iBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,OAAAF,IAAA,KAAAG,SAAA,QAAAC,GAAA,GAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,EAAAC,IAAA,2BAAAK,GAAA,sBAAAA,GAAA,YAAAE,SAAA,4DAAAP,IAAA,gBAAAF,MAAA,GAAAU,MAAA,EAAAT,KAAA;EAAA,SAAAU,2BAAAC,MAAA,EAAAC,QAAA,EAAAC,UAAA,EAAAC,WAAA;IAAA,OAAAD,UAAA,CAAAE,KAAA,GAAAC,OAAA,GAAAC,MAAA,WAAAC,oBAAA,EAAAC,SAAA;MAAA,OAAAA,SAAA,CAAAR,MAAA,EAAAC,QAAA,EAAAM,oBAAA,KAAAA,oBAAA;IAAA,GAAAJ,WAAA;EAAA;EAAA,SAAAM,0BAAAC,UAAA,EAAAC,OAAA,cAAAC,KAAA;EAAA;IAAAC,OAAA,aAAAC,+BAAA;MArSjBC,KAAK,GAAAD,+BAAA,CAALC,KAAK;IAAA,aAAAC,0BAAA;MACLC,OAAO,GAAAD,0BAAA,CAAPC,OAAO;MAAEC,YAAY,GAAAF,0BAAA,CAAZE,YAAY;IAAA,aAAAC,WAAA;MACrBC,aAAa,GAAAD,WAAA,CAAbC,aAAa;IAAA,aAAAC,SAAA;MACbC,sBAAsB,GAAAD,SAAA,CAAtBC,sBAAsB;IAAA,aAAAC,WAAA;MACtBC,QAAQ,GAAAD,WAAA,CAARC,QAAQ;MAAEC,6BAA6B,GAAAF,WAAA,CAA7BE,6BAA6B;IAAA,aAAAC,wBAAA;MAEfC,oCAAoC,GAAAD,wBAAA,CAApCC,oCAAoC;IAAA,aAAAC,gBAAA;MAE5DC,iBAAiB,GAAAD,gBAAA,CAAjBC,iBAAiB;IAAA,aAAAC,YAAA;MACjBC,YAAY,GAAAD,YAAA,CAAZC,YAAY;MAAEC,IAAI,GAAAF,YAAA,CAAJE,IAAI;IAAA,aAAAC,QAAA;MAClBC,iBAAiB,GAAAD,QAAA,CAAjBC,iBAAiB;IAAA;IAAAC,OAAA,WAAAA,CAAA;MAEpB7D,gCAAgC,GAAG,IAAI;MAAA8D,OAAA,2BAIvB7D,sBAAsB,IAAAP,IAAA,GAF3CiD,OAAO,CAAE,GAAEK,sBAAuB,wBAAuB,CAAC,EAAArD,KAAA,GAC1D4D,iBAAiB,CAAC,CAAC,EAAA7D,IAAA,CAAAE,MAAA,GAAAD,KAAA,CAAAC,MAAA,IAAAC,OAAA,GADpB,MAEsBI,sBAAsB,SAASiD,QAAQ,CAAC;QAC1Da,WAAWA,CAAEC,kBAAkB,GAAG,CAAC,EAAE;UACjC,KAAK,CAAC,CAAC;UAAC,KAAAC,MAAA,GAAAnE,YAAA,IAAAA,YAAA;UAAA,KAAAoE,gBAAA,GAAAnE,aAAA,IAAAA,aAAA;UAAA,KAsHJoE,uBAAuB,GAAG,IAAId,oCAAoC,CAAC,CAAC;UAAA,KAEpEe,iBAAiB,GAAiChD,SAAS;UAvH/D,IAAI,CAAC6C,MAAM,CAACI,MAAM,GAAGL,kBAAkB;UACvC,IAAI,CAACC,MAAM,CAACK,IAAI,CAAC,IAAI,CAAC;UACtB,IAAI,CAACJ,gBAAgB,CAACG,MAAM,GAAGL,kBAAkB;UACjD,IAAI,CAACE,gBAAgB,CAACI,IAAI,CAAC,GAAG,CAAC;QACnC;QAEOC,IAAIA,CAAElC,OAAqC,EAAQ;UACtD,KAAK,MAAMmC,IAAI,IAAI,IAAI,CAACP,MAAM,EAAE;YAC5BO,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAED,IAAI,CAAClC,OAAO,CAAC;UACvB;UACA,MAAMoC,gBAAgB,GAAG,IAAIjF,gBAAgB,CAAC,IAAI,CAACyE,MAAM,CAACI,MAAM,EAAE,IAAI,CAACK,cAAc,CAAC,CAAC,CAAC;UACxF,IAAI,CAACN,iBAAiB,GAAGK,gBAAgB;QAC7C;QAEOE,MAAMA,CAAEtC,OAAoC,EAAQ;UACvD,KAAK,MAAMmC,IAAI,IAAI,IAAI,CAACP,MAAM,EAAE;YAC5BO,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEG,MAAM,CAACtC,OAAO,CAAC;UACzB;QACJ;QAEOuC,OAAOA,CAAA,EAAU;UACpB,KAAK,MAAMJ,IAAI,IAAI,IAAI,CAACP,MAAM,EAAE;YAC5BO,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEI,OAAO,CAAC,CAAC;UACnB;QACJ;QAEUC,QAAQA,CAAExC,OAAoC,EAAQ;UAC5D,MAAM;YACF4B,MAAM,EAAEa,KAAK;YACbV,iBAAiB,EAAEK;UACvB,CAAC,GAAG,IAAI;UACRhB,YAAY,CAACgB,gBAAgB,CAAC;;UAE9B;UACAA,gBAAgB,CAACM,MAAM,CACnB1C,OAAO,CAAC2C,SAAS,EACjB,IAAI,CAACN,cAAc,CAAC,CAAC,EACrB,IAAI,CAACR,gBACT,CAAC;;UAED;UACA,IAAIO,gBAAgB,CAACQ,iBAAiB,CAAC,CAAC,EAAE;YACtC;UACJ;UAEA,MAAMC,MAAM,GAAGJ,KAAK,CAACT,MAAM;UAC3B,MAAM;YAAEc;UAAM,CAAC,GAAGV,gBAAgB;UAClChB,YAAY,CAAC0B,KAAK,CAACd,MAAM,KAAKa,MAAM,CAAC;;UAErC;UACA,KAAK,IAAIE,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGF,MAAM,EAAE,EAAEE,KAAK,EAAE;YACzC,MAAMC,MAAM,GAAGF,KAAK,CAACC,KAAK,CAAC,CAACC,MAAM;YAClC,IAAIzB,iBAAiB,CAACyB,MAAM,CAAC,EAAE;cAC3B;YACJ;YACA,MAAMb,IAAI,GAAGM,KAAK,CAACM,KAAK,CAAC;YACzB,MAAME,iBAAiB,GAAG,IAAI,CAACnB,uBAAuB,CAACoB,QAAQ,CAC3DlD,OAAO,CAAC2C,SAAS,EACjB3C,OAAO,CAACmD,gBAAgB,GAAGH,MAC/B,CAAC;YACDb,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEO,MAAM,CAACO,iBAAiB,CAAC;UACnC;QACJ;QAEOG,UAAUA,CAAEpD,OAAwC,EAAQ;UAC/D,MAAM;YACF4B,MAAM,EAAEa,KAAK;YACbV,iBAAiB,EAAEK;UACvB,CAAC,GAAG,IAAI;UACRhB,YAAY,CAACgB,gBAAgB,CAAC;UAC9B,MAAMiB,gBAAgB,GAAGvC,6BAA6B,CAACwC,KAAK;UAC5D,MAAMT,MAAM,GAAGJ,KAAK,CAACT,MAAM;UAC3B,MAAM;YAAEc;UAAM,CAAC,GAAGV,gBAAgB;UAClChB,YAAY,CAAC0B,KAAK,CAACd,MAAM,KAAKS,KAAK,CAACT,MAAM,CAAC;UAE3C,IAAIuB,SAAsB,GAAG,IAAI;UACjC,IAAI,CAACnB,gBAAgB,CAACQ,iBAAiB,CAAC,CAAC,EAAE;YACvC,IAAIY,SAAS,GAAG,GAAG;YACnB,KAAK,IAAIC,UAAU,GAAG,CAAC,EAAEA,UAAU,GAAGZ,MAAM,EAAE,EAAEY,UAAU,EAAE;cAAA,IAAAC,iBAAA;cACxD,MAAMC,eAAe,GAAGvB,gBAAgB,CAACU,KAAK,CAACW,UAAU,CAAC,CAACT,MAAM;cACjE,IAAIzB,iBAAiB,CAACoC,eAAe,CAAC,EAAE;gBACpC;cACJ;cACA,MAAMC,SAAS,IAAAF,iBAAA,GAAGjB,KAAK,CAACgB,UAAU,CAAC,cAAAC,iBAAA,uBAAjBA,iBAAA,CAAmBG,QAAQ,CAAC7D,OAAO,EAAEc,6BAA6B,CAACwC,KAAK,CAAC;cAC3F,IAAI,CAACM,SAAS,EAAE;gBACZ;cACJ;cACAJ,SAAS,IAAIG,eAAe;cAC5B,IAAI,CAACJ,SAAS,EAAE;gBACZA,SAAS,GAAGK,SAAS;cACzB,CAAC,MAAM;gBACH,IAAIJ,SAAS,EAAE;kBACX,MAAMM,CAAC,GAAGH,eAAe,GAAGH,SAAS;kBACrC/C,aAAa,CAAC8C,SAAS,EAAEK,SAAS,EAAEE,CAAC,CAAC;gBAC1C;gBACA9D,OAAO,CAAC+D,OAAO,CAAC,CAAC;cACrB;YACJ;UACJ;UAEA,IAAIR,SAAS,EAAE;YACX,OAAOA,SAAS;UACpB;UAEA,OAAO3F,sBAAsB,CAACoG,mBAAmB,CAAChE,OAAO,EAAEqD,gBAAgB,CAAC;QAChF;QAQUhB,cAAcA,CAAA,EAAY;UAChC,OAAO,CAAC;QACZ;MAKJ,CAAC,GAAA5E,YAAA,GAAA2B,0BAAA,CAAA5B,OAAA,CAAAyG,SAAA,aAbI1D,YAAY;QAAA,OAC2B,EAAE;MAAA,IAAA7C,aAAA,GAAA0B,0BAAA,CAAA5B,OAAA,CAAAyG,SAAA,uBAEzC1D,YAAY;QAAA,OAC0B,EAAE;MAAA,KAAA/C,OAAA,MAAAD,MAAA,KAAAA,MAAA;MAWvCJ,gBAAgB,GAAtB,MAAMA,gBAAgB,CAAC;QACnBuE,WAAWA,CACPwC,SAAiB,EACjBC,kBAA0B,EAC5B;UAAA,KAmEMC,MAAM;UAAA,KAENC,gBAAgB,GAAG,CAAC,CAAC;UAAA,KAErBC,sBAAsB,GAAG,GAAG;UAAA,KAE5BC,iBAAiB,GAAG,GAAG;UAxE3B,MAAMzB,KAAK,GAAI0B,KAAK,CAACC,IAAI,CAAC;YAAEzC,MAAM,EAAEkC;UAAU,CAAC,EAAE,MAA4B,IAAI9G,oBAAoB,CAAC,CAAC,CAAC;UACxG,IAAI+G,kBAAkB,IAAI,CAAC,IAAIA,kBAAkB,GAAGD,SAAS,EAAE;YAC3DpB,KAAK,CAACqB,kBAAkB,CAAC,CAACO,gBAAgB,GAAG,GAAG;YAChD5B,KAAK,CAACqB,kBAAkB,CAAC,CAACQ,gBAAgB,GAAG,GAAG;YAChD7B,KAAK,CAACqB,kBAAkB,CAAC,CAACnB,MAAM,GAAG,GAAG;UAC1C;UACA,IAAI,CAACoB,MAAM,GAAGtB,KAAK;QACvB;QAEA,IAAIA,KAAKA,CAAA,EAA6C;UAClD,OAAO,IAAI,CAACsB,MAAM;QACtB;QAEOxB,iBAAiBA,CAAA,EAAa;UACjC,OAAO,IAAI,CAACyB,gBAAgB,GAAG,CAAC;QACpC;QAEO3B,MAAMA,CAAEC,SAAiB,EAAEiC,aAAqB,EAAEC,eAAkC,EAAQ;UAC/FzD,YAAY,CAACuB,SAAS,IAAI,GAAG,CAAC;UAE9B,IAAI,CAACmC,iBAAiB,CAACF,aAAa,EAAEC,eAAe,CAAC;UAEtD,IAAI,IAAI,CAACR,gBAAgB,GAAG,CAAC,EAAE;YAC3B;UACJ;UAEA,MAAM;YACFC,sBAAsB,EAAES,qBAAqB;YAC7CR,iBAAiB,EAAES,gBAAgB;YACnCZ,MAAM,EAAEtB;UACZ,CAAC,GAAG,IAAI;;UAER;UACA;UACA,IAAIiC,qBAAqB,IAAIC,gBAAgB,EAAE;YAC3C;UACJ;UAEA,MAAMnC,MAAM,GAAGC,KAAK,CAACd,MAAM;UAC3B,IAAIwB,SAAS,GAAG,GAAG;UACnB,IAAIyB,wBAAwB,GAAG,GAAG;UAClC,MAAMC,MAAM,GAAGF,gBAAgB,GAAGD,qBAAqB;UACvD,IAAIpC,SAAS,GAAGuC,MAAM,EAAE;YACpB,IAAI,CAACZ,sBAAsB,GAAGU,gBAAgB;YAC9CC,wBAAwB,GAAG,GAAG;UAClC,CAAC,MAAM;YACH,IAAI,CAACX,sBAAsB,IAAI3B,SAAS;YACxCsC,wBAAwB,GAAG,IAAI,CAACX,sBAAsB,GAAGU,gBAAgB;UAC7E;UACA5D,YAAY,CAAC6D,wBAAwB,IAAI,GAAG,IAAIA,wBAAwB,IAAI,GAAG,CAAC;UAChF,KAAK,IAAIlC,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGF,MAAM,EAAE,EAAEE,KAAK,EAAE;YACzC,MAAMoC,IAAI,GAAGrC,KAAK,CAACC,KAAK,CAAC;YACzB,MAAMqC,UAAU,GAAG/D,IAAI,CAAC8D,IAAI,CAACT,gBAAgB,EAAES,IAAI,CAACR,gBAAgB,EAAEM,wBAAwB,CAAC;YAC/FzB,SAAS,IAAI4B,UAAU;YACvBD,IAAI,CAACnC,MAAM,GAAGoC,UAAU;UAC5B;UACA,IAAI,CAAC7D,iBAAiB,CAACiC,SAAS,CAAC,EAAE;YAC/B,KAAK,IAAIT,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGF,MAAM,EAAE,EAAEE,KAAK,EAAE;cACzC,MAAMoC,IAAI,GAAGrC,KAAK,CAACC,KAAK,CAAC;cACzBoC,IAAI,CAACnC,MAAM,IAAIQ,SAAS;YAC5B;UACJ,CAAC,MAAM,IAAIpD,KAAK,EAAE;YACdgB,YAAY,CAAC0B,KAAK,CAACuC,KAAK,CAAEF,IAAI,IAAKA,IAAI,CAACnC,MAAM,KAAK,GAAG,CAAC,CAAC;UAC5D;QACJ;QAUQ8B,iBAAiBA,CAAEF,aAAqB,EAAEC,eAAkC,EAAQ;UACxF,MAAM;YACFT,MAAM,EAAEtB,KAAK;YACbuB,gBAAgB,EAAEiB;UACtB,CAAC,GAAG,IAAI;UACR,MAAMzC,MAAM,GAAGC,KAAK,CAACd,MAAM;UAC3B,IAAI,CAACa,MAAM,EAAE;YACT;UACJ;;UAEA;UACA,IAAI+B,aAAa,KAAKU,aAAa,EAAE;YACjC;UACJ;;UAEA;UACA;UACA;UACA,IAAIV,aAAa,GAAG,CAAC,IAAIA,aAAa,IAAI/B,MAAM,EAAE;YAC9C;UACJ;;UAEA;UACA;UACA;;UAEA,MAAM0C,iBAAiB,GAAGC,IAAI,CAACC,GAAG,CAACZ,eAAe,CAACD,aAAa,CAAC,EAAE,GAAG,CAAC;UACvE;UACA;UACA;UACA;UACA,IAAIW,iBAAiB,GAAG5H,gCAAgC,EAAE;YACtD,KAAK,IAAIoF,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGF,MAAM,EAAE,EAAEE,KAAK,EAAE;cACzC,MAAMoC,IAAI,GAAGrC,KAAK,CAACC,KAAK,CAAC;cACzB,IAAIA,KAAK,KAAK6B,aAAa,EAAE;gBACzBO,IAAI,CAACT,gBAAgB,GAAG,GAAG;gBAC3BS,IAAI,CAACR,gBAAgB,GAAG,GAAG;gBAC3BQ,IAAI,CAACnC,MAAM,GAAG,GAAG;cACrB,CAAC,MAAM;gBACHmC,IAAI,CAACT,gBAAgB,GAAG,GAAG;gBAC3BS,IAAI,CAACR,gBAAgB,GAAG,GAAG;gBAC3BQ,IAAI,CAACnC,MAAM,GAAG,GAAG;cACrB;YACJ;UACJ,CAAC,MAAM;YACH,MAAM0C,yBAAyB,GAAG,IAAI,CAACnB,iBAAiB,GAAG5G,gCAAgC,GACrF,GAAG,GACH,IAAI,CAAC2G,sBAAsB,GAAG,IAAI,CAACC,iBAAiB;YAC1D,KAAK,IAAIxB,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGF,MAAM,EAAE,EAAEE,KAAK,EAAE;cACzC,MAAMoC,IAAI,GAAGrC,KAAK,CAACC,KAAK,CAAC;cACzB;cACA;cACAoC,IAAI,CAACT,gBAAgB,GAAGrD,IAAI,CACxB8D,IAAI,CAACT,gBAAgB,EAAES,IAAI,CAACR,gBAAgB,EAAEe,yBAClD,CAAC;cACD,IAAI3C,KAAK,KAAK6B,aAAa,EAAE;gBACzBO,IAAI,CAACR,gBAAgB,GAAG,GAAG;cAC/B,CAAC,MAAM;gBACHQ,IAAI,CAACR,gBAAgB,GAAG,GAAG;cAC/B;YACJ;UACJ;UAEA,IAAI,CAACN,gBAAgB,GAAGO,aAAa;UACrC,IAAI,CAACN,sBAAsB,GAAG,GAAG;UACjC,IAAI,CAACC,iBAAiB,GAAGgB,iBAAiB;QAC9C;MACJ,CAAC;MAMKnI,oBAAoB,GAA1B,MAAMA,oBAAoB,CAAyC;QAAAsE,YAAA;UAAA,KACxDgD,gBAAgB,GAAG,GAAG;UAAA,KAEtBC,gBAAgB,GAAG,GAAG;UAE7B;UAAA,KACO3B,MAAM,GAAG,GAAG;QAAA;MACvB,CAAC;IAAA;EAAA;AAAA"}