{"version":3,"names":["RenderShadowMapBatchedQueue","_phaseID","_defineProperty","obj","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","getShadowPassIndex","subModel","passes","r","cclegacy","rendering","isEnableEffect","getPhaseID","getPassID","k","length","enableEffectImport","phase","phaseID","_export","setters","_defineJs","SetIndex","_passPhaseJs","_pipelineStateManagerJs","PipelineStateManager","_renderSceneCorePassJs","BatchingSchemes","_renderInstancedQueueJs","RenderInstancedQueue","_renderSceneSceneShadowsJs","ShadowType","_renderSceneSceneLightJs","LightType","_coreIndexJs","geometry","_sceneCullingJs","shadowCulling","execute","constructor","pipeline","_pipeline","_subModelsArray","_passArray","_shaderArray","_instancedQueue","gatherLightPasses","camera","light","cmdBuff","level","clear","sceneData","pipelineSceneData","shadowInfo","shadows","enabled","type","ShadowMap","DIRECTIONAL","dirLight","shadowEnabled","csmLayers","layer","shadowFixedArea","specialLayer","layers","dirShadowObjects","shadowObjects","i","ro","model","add","SPOT","spotLight","visibility","castShadowObjects","worldBounds","node","intersect","aabbFrustum","frustum","uploadBuffers","subModels","j","shadowPassIdx","pass","batchingScheme","INSTANCING","buffer","getInstancedBuffer","merge","queue","shader","shaders","push","recordCommandBuffer","device","renderPass","ia","inputAssembler","pso","getOrCreatePipelineState","descriptorSet","bindPipelineState","bindDescriptorSet","MATERIAL","LOCAL","bindInputAssembler","draw"],"sources":["file:///Users/henryliu/obelisk/fish-game/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/rendering/render-shadow-map-batched-queue.ts"],"mappings":"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"}