{"version":3,"names":["SpotLight","_forward","_qt","_matView","_matProj","_matViewProj","_matViewProjInv","_defineProperty","obj","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","_export","setters","_coreIndexJs","Mat4","Quat","Vec3","geometry","cclegacy","_lightJs","Light","LightType","nt2lm","_shadowsJs","PCFType","execute","position","_pos","size","_size","range","_range","_needUpdate","luminance","isHDR","director","root","pipeline","pipelineSceneData","_luminanceHDR","_luminanceLDR","luminanceHDR","luminanceLDR","direction","_dir","spotAngle","_spotAngle","val","_angle","Math","cos","angleAttenuationStrength","_angleAttenuationStrength","angle","aabb","_aabb","frustum","_frustum","shadowEnabled","_shadowEnabled","shadowPcf","_shadowPcf","shadowBias","_shadowBias","shadowNormalBias","_shadowNormalBias","constructor","PI","HARD","AABB","create","Frustum","_type","SPOT","initialize","set","update","_node","hasChangedFlags","getWorldPosition","transformQuat","getWorldRotation","normalize","x","y","z","getWorldRT","invert","perspective","multiply"],"sources":["file:///Users/henryliu/obelisk/fish-game/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/render-scene/scene/spot-light.ts"],"mappings":"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"}