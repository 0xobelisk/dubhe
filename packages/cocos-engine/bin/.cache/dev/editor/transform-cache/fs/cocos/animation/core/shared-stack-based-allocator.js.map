{"version":3,"names":["SharedMemoryPage","PagedStack","SharedMemorySlice","SharedStackBasedAllocator","SharedStackBasedAllocatorManager","allocatorPageCountTag","onStackPurgedTag","_export","setters","_virtualInternal253AconstantsJs","DEBUG","_coreIndexJs","assertIsTrue","binarySearchEpsilon","execute","Symbol","constructor","byteLength","buffer","useCount","ArrayBuffer","_manager","_pageSize","_locking","_pages","_allocatorCount","pageSize","debugLocking","allocatorCount","debugLock","debugUnlock","getPageMemory","index","length","pushPage","allocator","oldAllocatorPageCount","_pushNewPage","page","popPage","allocatorPageCount","allocatorLastPageIndex","lastPage","pop","createAllocator","sliceSize","destroyAllocator","iPage","newPage","push","byteOffset","_resource","_sliceSize","_slicesPerPage","_slices","slicesPerPage","Math","floor","isEmpty","destroy","sliceLength","slices","desiredSliceIndex","newSliceIndexInPage","newSlicePageIndex","capacity","pageMemory","newSlice","allocatedCount","removingSliceIndex","removingSliceIndexInPage","_thresholds","_stacks","Map","every","v","i","arr","size","allocationPageSize","stackPageSize","_selectStackPageSize","stack","get","set","stackFound","k","delete","thresholdIndex"],"sources":["file:///Users/henryliu/obelisk/fish-game/CocosCreator.app/Contents/Resources/resources/3d/engine/cocos/animation/core/shared-stack-based-allocator.ts"],"mappings":"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"}